<!DOCTYPE html>
<html>
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
 <body>
 
 <div style="height:auto; width:700px">
 <canvas id="myChart"></canvas>
</div>

<input id="addressInput" ></input>

<input id="amountInput" ></input>

<button id="postButton">update</button>


 <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.js"></script>
 
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
 
 <script>
 
 $(document).ready(function(){
  
 $.post("http://localhost:9615/")
  .then(function(d) {
      addDataToChart(JSON.parse(d))
    });
      
  });
 
 
 $("#postButton").click(function(){
    var addressValue = document.getElementById("addressInput").value;
	var amountValue = document.getElementById("amountInput").value;
	if(addressValue && amountValue){
	addData(myChart, addressValue, amountValue);
	var data = {'requestType': 'addToDatabase', 'addressInput': addressValue, 'amountInput': amountValue};
	/*$.post("http://localhost:9615", data,
		  function(d) {
			
		}
	);*/
	
	
	$.ajax({
		url:"http://localhost:9615/containstype",
		type:"POST",
		data:data,
		contentType:"application/json; charset=utf-8",
		dataType:"json",
		success: function(d){
			//console.log(d);
		}
})
	
	}
  });
   
 function addDataToChart(d){
   for(var i = 0; i < d.length; i++){
		addData(myChart, d[i].address, d[i].amount);
		//console.log(d[i]);
   }
 }
 
 
 function removeData(chart) {
    myChart.data.labels.pop();
    myChart.data.datasets.forEach((dataset) => {
        dataset.data.pop();
    });
    myChart.update();
}

function addData(chart, label, data) {
    chart.data.labels.push(label);
    chart.data.datasets.forEach((dataset) => {
        dataset.data.push(data);
    });
    chart.update();
}
  
 var ctx = document.getElementById('myChart').getContext('2d');
 
var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
        datasets: [{
            label: '# of Transactions Overall',
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        }
    }
});

/*var ctx = document.getElementById('myRadarChart').getContext('2d');

var radarDataSets = [{
						label: '# of Transactions on Jan.',
						data: [12, 19, 3, 5, 21, 3],
						backgroundColor: 'rgba(255, 99, 132, 0.2)'
					},
					{
						label: '# of Transactions on Feb.',
						data: [1, 23, 15, 12, 7, 9],
						backgroundColor: 'rgba(54, 162, 235, 0.2)'
					}
					]

var myChart2 = new Chart(ctx, {
    type: 'radar',
    data: {
        labels: ['Address1', 'Address2', 'Address3', 'Address4', 'Address5', 'Address6'],
        datasets: radarDataSets
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        }
    }
});*/
 </script>
 
  </body>
 </html>